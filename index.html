<!doctype html>
<html lang="ko">
  <head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T5KD45HC');</script>
    <!-- End Google Tag Manager -->
    
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="app_title">YT subscription backup</title>
    <meta
      name="description"
      content="내 YouTube 구독 채널 수를 확인하고, Export/Import로 구독 중인 YouTube 채널 목록을 백업·정리·재적용하는 정적 웹 서비스."
    />
    <style>
      :root { color-scheme: light dark; }
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; }
      main { max-width: 880px; margin: 0 auto; padding: 24px 16px 72px; }
      .topbar { display: flex; justify-content: space-between; align-items: center; gap: 10px; margin-bottom: 10px; }
      .brand { display: flex; align-items: center; gap: 10px; }
      .logo { width: 36px; height: 36px; border-radius: 10px; }
      h1 { margin: 0 0 10px; font-size: 26px; }
      h2 { margin: 28px 0 10px; font-size: 18px; }
      p { line-height: 1.55; margin: 10px 0; }
      .muted { opacity: 0.75; }
      .card { border: 1px solid color-mix(in srgb, currentColor 18%, transparent); border-radius: 12px; padding: 14px; }
      .row { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; }
      .row > * { flex: 0 0 auto; }
      input[type="text"] { width: min(720px, 100%); padding: 10px 12px; border-radius: 10px; border: 1px solid color-mix(in srgb, currentColor 22%, transparent); }
      select { padding: 8px 10px; border-radius: 10px; border: 1px solid color-mix(in srgb, currentColor 22%, transparent); background: transparent; }
      button { padding: 10px 12px; border-radius: 10px; border: 1px solid color-mix(in srgb, currentColor 22%, transparent); background: color-mix(in srgb, currentColor 6%, transparent); cursor: pointer; }
      button:disabled { opacity: 0.6; cursor: not-allowed; }
      code { font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size: 0.95em; }
      .status { white-space: pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size: 12px; padding: 10px; border-radius: 10px; background: color-mix(in srgb, currentColor 6%, transparent); border: 1px solid color-mix(in srgb, currentColor 16%, transparent); }
      .danger { border-color: color-mix(in srgb, #e11d48 45%, transparent); }
      .danger button { border-color: color-mix(in srgb, #e11d48 45%, transparent); }
      .pill { display: inline-block; padding: 2px 8px; border-radius: 999px; border: 1px solid color-mix(in srgb, currentColor 22%, transparent); font-size: 12px; }
      .grid { display: grid; grid-template-columns: 1fr; gap: 12px; }
      @media (min-width: 860px) { .grid { grid-template-columns: 1fr 1fr; } }
      .statCard { display: grid; gap: 10px; }
      .statValue { font-size: 42px; font-weight: 800; line-height: 1; letter-spacing: -0.02em; }
      .statLabelRow { display: flex; align-items: center; justify-content: space-between; gap: 10px; flex-wrap: wrap; }
      
      /* Loading Overlay */
      #loadingOverlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: 9999;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(4px);
      }
      #loadingOverlay.active {
        display: flex;
      }
      .loadingContent {
        background: color-mix(in srgb, currentColor 95%, transparent);
        padding: 32px 40px;
        border-radius: 16px;
        text-align: center;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        max-width: 400px;
      }
      .spinner {
        width: 48px;
        height: 48px;
        border: 4px solid color-mix(in srgb, currentColor 20%, transparent);
        border-top-color: currentColor;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
        margin: 0 auto 16px;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      .loadingText {
        font-size: 16px;
        font-weight: 500;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5KD45HC"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay">
      <div class="loadingContent">
        <div class="spinner"></div>
        <p class="loadingText" data-i18n="loading_message">Processing...</p>
      </div>
    </div>
    
    <main>
      <div class="topbar">
        <div class="brand">
          <img class="logo" src="./logo-120.svg" width="36" height="36" data-i18n="app_logo_alt" data-i18n-attr="alt" alt="App logo" />
          <h1 data-i18n="app_title">YT subscription backup</h1>
        </div>
        <div class="row" style="gap: 8px;">
          <label for="lang" class="muted" data-i18n="lang_label">언어</label>
          <select id="lang" aria-label="language select">
            <option value="ko">한국어</option>
            <option value="en">English</option>
            <option value="ja">日本語</option>
          </select>
        </div>
      </div>

      <p class="muted" data-i18n="app_intro_1" data-i18n-params='{"pill":"i18n:app_tag_pill"}'></p>
      <p class="muted">
        <span data-i18n="app_intro_2" data-i18n-params='{"strong":"i18n:app_intro_strong"}'></span>
      </p>

      <div class="grid">
        <section class="card" aria-label="OAuth settings">
          <h2 data-i18n="sec1_title">1) Google OAuth</h2>
          <p class="muted">
            <span data-i18n="sec1_desc"></span>
          </p>
          <div class="row" style="margin-top:10px;">
            <button id="authButton" data-i18n="btn_auth">Sign in with YouTube</button>
          </div>
        </section>

        <section class="card" aria-label="status">
          <h2 data-i18n="sec2_title">2) 내 구독 현황</h2>
          <div class="statCard">
            <div class="statValue" id="subsCount">-</div>
            <div class="statLabelRow">
              <span class="pill"><span data-i18n="subs_label">Subscriptions</span></span>
              <button id="refreshCount" data-i18n="btn_refresh_count">Refresh count</button>
            </div>
          </div>
        </section>
      </div>

      <section class="card" aria-label="export" style="margin-top: 12px;">
        <h2 data-i18n="sec3_title">3) Export (다운로드)</h2>
        <p class="muted" data-i18n="sec3_desc">현재 구독 중인 YouTube 채널 목록을 JSON/CSV 파일로 내려받습니다.</p>
        <div class="row">
          <button id="exportJson" data-i18n="btn_export_json">Export JSON</button>
          <button id="exportCsv" data-i18n="btn_export_csv">Export CSV</button>
        </div>
      </section>

      <section class="card danger" aria-label="cleanup" style="margin-top: 12px;">
        <h2 data-i18n="sec4_title">4) Cleanup (전체 구독 취소)</h2>
        <p class="muted" data-i18n="sec4_desc">
          Export를 먼저 수행한 뒤, typed confirm으로 한 번 더 확인하고 전체 구독을 취소합니다.
        </p>
        <div class="row">
          <button id="cleanupJson" data-i18n="btn_cleanup_json">Cleanup after Export (JSON)</button>
          <button id="cleanupCsv" data-i18n="btn_cleanup_csv">Cleanup after Export (CSV)</button>
        </div>
      </section>

      <section class="card" aria-label="import" style="margin-top: 12px;">
        <h2 data-i18n="sec5_title">5) Import (파일을 적용해서 구독 추가)</h2>
        <p class="muted" data-i18n="sec5_desc">
          백업 파일(JSON/CSV)을 업로드하면, 현재 구독 중인 YouTube 채널 목록과 비교해 부족한 채널만 구독 추가합니다.
        </p>
        <div class="row">
          <input id="importFile" type="file" accept=".json,.csv,application/json,text/csv" />
          <button id="applyImport" disabled data-i18n="btn_apply_import">Apply import (subscribe)</button>
        </div>
        <div id="importPreview" class="status" style="margin-top:10px;" data-i18n="import_no_file">No file loaded.</div>
      </section>

      <section class="card" aria-label="support" style="margin-top: 12px;">
        <h2 data-i18n="support_title">Support</h2>
        <p class="muted">
          <span data-i18n="support_desc">If this app helped you, consider supporting the project:</span>
        </p>
        <p style="margin-top:8px;">
          <a href="https://www.buymeacoffee.com/e3pbwto"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=e3pbwto&button_colour=FFDD00&font_colour=000000&font_family=Lato&outline_colour=000000&coffee_colour=ffffff" /></a>
        </p>
        <p class="muted">
          <a href="./privacy.html" data-i18n="legal_privacy">Privacy Policy</a>
          ·
          <a href="./terms.html" data-i18n="legal_terms">Terms of Service</a>
        </p>
      </section>
    </main>

    <script type="module" src="/src/web/main.ts"></script>
  </body>
</html>

